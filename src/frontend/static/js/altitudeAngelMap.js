var aa=function(){"use strict";let e,t,i,n,a=!1,s=function(){const a={en:{translation:{loading:"Loading",pleaseWait:"Please wait...",pleaseRefresh:"Please refresh the page to accept the terms and conditions.",tsAndCsRefused:"Terms and conditions Refused"}},nl:{translation:{loading:"Bezig met laden",pleaseWait:"Wacht alsjeblieft...",pleaseRefresh:"Vernieuw de pagina om de algemene voorwaarden te accepteren.",tsAndCsRefused:"Algemene voorwaarden geweigerd"}}},s="-";function r(){let t=document.getElementById(e.target);if(!t)throw{message:"Altitude Angel Map cannot find element named "+e.target+" to inject into. Please ensure that an element with that name exists."};{n=e.baseUrl,i=document.createElement("iframe"),i.src=e.baseUrl+"/frame.html?"+(new Date).getTime(),i.id="map-frame",i.allow="geolocation",i.style.border="none",i.style.padding="0",i.style.margin="0",i.style.position="absolute";let l=document.createElement("iframe");l.id="loading-frame",l.style.backgroundColor="#777777",l.style.border="none",l.style.padding="0",l.style.margin="0";let c=document.createElement("iframe");c.id="refusal-frame",c.style.backgroundColor="#777777",c.style.border="none",c.style.padding="0",c.style.margin="0",e.isFixedSize?(i.width=e.width,i.height=e.height,l.width=e.width+"px",l.height=e.height+"px",l.border="none",c.width=e.width+"px",c.height=e.height+"px",c.border="none"):(navigator&&navigator.userAgent&&null!=navigator.userAgent&&null!=navigator.userAgent.toLowerCase().match(/(ipad)/)?(i.style.width=0,i.style.height=0,i.style["max-width"]="100%",i.style["max-height"]="100%",i.style["min-width"]="100%",i.style["min-height"]="100%"):(i.style.width="100%",i.style.height="100%"),l.style.width="100%",l.style.height="100%",c.style.width="100%",c.style.height="100%");const g=e.internationalization?d(e.internationalization.languages):d();if(function(e){var t,i=document.createElement("iframe");i.style.display="none",i.setAttribute("src",e),document.body.appendChild(i);try{t=!!i.contentDocument}catch(e){t=!1}return document.body.removeChild(i),t}("data:;base64,")){const e=a[g].translation;var s='<!DOCTYPE html>\r\n<html><head><link href="'+n+'/client/altitudeAngel.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"></head><body><div class="loading-container"><h1 class="loading-item loading-item-top">'+e.loading+'</h1><img class="loading-item loading-item-middle" src="'+n+'/images/busy_transparent_big.gif" /><span class="loading-item loading-item-bottom">'+e.pleaseWait+"</span></div></body></html>",r='<!DOCTYPE html>\r\n<html><head><link href="'+n+'/client/altitudeAngel.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"></head><body><div class="loading-container"><h1 class="loading-item loading-item-top">'+e.tsAndCsRefused+'</h1><div class="loading-item loading-item-bottom">'+e.pleaseRefresh+"</div></div></body></html>";l.src="data:text/html;charset=utf-8,"+escape(s),c.src="data:text/html;charset=utf-8,"+escape(r)}else l.src=n+"/client/loading/"+g+".html",c.src=n+"/client/refusal/"+g+".html";o.setMessageCallback("termsRefused",(function(e){t.removeChild(i),t.appendChild(c)})),i.onload=function(){setTimeout((function(){t.removeChild(l)}),100)},t.appendChild(i),t.appendChild(l)}}function d(t){if(e.features.indexOf(l.internationalization)>-1){let i=window.location.hostname+"/aa.map.i18nLanguage";e.instanceId&&(i=e.instanceId+"/"+i);const n=localStorage.getItem(i);if(n){const e=JSON.parse(n);if(g(e))return e}if(void 0!==t&&t.length>0){const e=c(t);if(e)return e}else{const e=window.navigator.userLanguage||window.navigator.language,t=c(window.navigator.languages||[e]);if(t)return t}}return"en"}function c(e){for(let t=0;t<e.length;t+=1){const i=e[t];if(g(i))return i}const t=e.filter(h).map(p).filter((function(e,t,i){return i.indexOf(e)===t})).filter(g);return t.length>0?t[0]:null}function g(e){return void 0!==a[e]}function h(e){return e.indexOf(s)>-1}function p(e){return h(e)?e.substring(0,e.indexOf(s)):e}return{load:function(i,n){e=function(e){if(!e)throw"Settings must be specified with at least a 'target' property";return e.height||(e.height=800),e.width||(e.width=800),e.features||(e.features=[]),e}(i),t=n,o.initialize(),r()},dispose:function(){!function(){const e=document.getElementById("map-frame");e&&e.parentNode&&e.parentNode.removeChild(e)}(),o.dispose()}}}(),o=function(){let a={};function s(e){let t=JSON.stringify(e);i.contentWindow.postMessage(t,n)}function o(i){let o=i.origin||i.originalEvent.origin;if(-1!==!n.indexOf(o)){if(i.data&&"string"==typeof i.data)try{!function(i){if(!i)return;switch(i.type){case"mapStateChanged":1==i.state&&t&&t();default:a[i.type]&&a[i.type](i)}}(JSON.parse(i.data))}catch(e){console.log("Problem JSON string data:",i.data),console.error(e)}}else console.log("Message received from incorrect domain. Unknown origin: "+o+" expected: "+n)}return{dispose:function(){window.removeEventListener("message",o),a={}},initialize:function(){window.addEventListener("message",o)},sendMessage:s,setMessageCallback:function(e,t){a[e]=t},clearMessageCallback:function(e){a[e]=void 0}}}();let r={map:{centerMap:function(e,t){o.sendMessage({type:"setMapCenter",position:{latitude:e,longitude:t}})},fitToGeoJson:function(){o.sendMessage({type:"map.fitToGeoJson"})},refreshAirspaces:function(){o.sendMessage({type:"refreshAirspaces"})},takeScreenshot:function(){o.sendMessage({type:"map.screenshot"})},displayFeature:function(e){o.sendMessage({type:"map.displayFeature",features:e})}},modules:{mapDrawing:{startDrawing:function(e){o.sendMessage({type:"mapDrawing.startDrawing",drawingTypes:e})},displayDrawing:function(e){o.sendMessage({type:"mapDrawing.displayDrawing",geoJson:e})}},routePlanning:{displayFlightPlan:function(e){o.sendMessage({type:"routePlanning.displayFlightPlan",missionPlan:e})},displayNonStandardFlightRequestInfo:function(e){o.sendMessage({type:"routePlanning.displayNonStandardFlightRequestInfo",nsfrs:e})},setVlosAirspaceRadius:function(e){o.sendMessage({type:"routePlanning.setVlosAirspaceRadius",vlosAirspaceRadius:e})}},dcz:{addDcz:function(e,t){o.sendMessage({type:"dcz.add",dczId:e,definition:t})},answerDczFlightPermission:function(e){o.sendMessage({type:"dcz.answerFlightPermission",response:e})},clearDcz:function(e){o.sendMessage({type:"dcz.clear",dczId:e})}},monitoredFlight:{setFlightSelected:function(e){o.sendMessage({type:"monitoredFlight.setFlightSelected",aircraftId:e})},setFlightDeselected:function(e){o.sendMessage({type:"monitoredFlight.setFlightDeselected",aircraftId:e})}},tower:{setTower:function(e){o.sendMessage({type:"tower.set",towerId:e})},showAllRangeMarkers:function(e){o.sendMessage({type:"tower.showAllRangeMarkers",showAllRangeMarkers:e})},showSelectedTowerRangeMarkers:function(e){o.sendMessage({type:"tower.showSelectedTowerRangeMarkers",showSelectedTowerRangeMarkers:e})},showAllCameraArcs:function(e){o.sendMessage({type:"tower.showAllCameraArcs",showAllCameraArcs:e})},showSelectedTowerCameraArcs:function(e){o.sendMessage({type:"tower.showSelectedTowerCameraArcs",showSelectedTowerCameraArcs:e})}},zone:{setZones:function(e){o.sendMessage({type:"zones.set",zoneIds:e})}}},realTime:{monitorDcz:function(e){o.sendMessage({type:"monitorDcz",dczId:e})}}};const l={aircraftHub:"aircraft_hub",regionMonitor:"region_monitor",tacticalDeconfliction:"tactical_deconfliction",realTimeFlightData:"realtime_flight_data",hideAirspaceSelection:"hide_airspace_selection",hideMenuPanel:"hide_menu_panel",hideMenuBar:"hide_menu_bar",mapDrawing:"map_drawing",manageDcz:"manage_dcz",viewDcz:"view_dcz",showInteractionRegion:"show_interaction_region",flightReportsV2:"conditional_flight_reports",hideSearch:"hide_search",hideViewAirspaceDetails:"hide_view_airspace_details",hideFlightReportsUi:"hide_flight_reports_ui",laancFlightReports:"laanc_flight_reports",ukCommercialFlightView:"uk_commercial_flight_view",offerMaximiseWhenConstrained:"offer_maximise_button_when_constrained",realTimeDataLink:"real_time_data_link",displayFullscreenOption:"display_fullscreen_option",displayFitToGeoJsonOption:"display_fit_to_geojson_option",disableRegulationSelection:"disable_regulation_selection",internationalization:"internationalization",lvnlElevationTileset:"lvnl_elevation_tileset",asaElevationTileset:"asa_elevation_tileset",asaLidarElevationTileset:"asa_lidar_elevation_tileset",azureTileMaps:"azure_tile_maps",asaNoiseComplaintButton:"asa_noise_complaint_button",currentLocationOnStart:"current_location_on_start",hideOrdnanceSurveyTileset:"hide_ordnance_survey_tileset",droneDisclaimer:"drone_disclaimer",useOfDronesLinks:"use_of_drones_links",hideFlightReportIncidentButton:"hide_flight_report_incident_button",displayUserLocation:"display_user_location",circleRadiusControls:"circle_radius_controls",opaqueTokenFormat:"opaque_token_format",closeAirspace:"close_airspace",flightApproval:"flight_approval",flightInstructions:"flight_instructions",tacticalControl:"tactical_control",noFlyZones:"no_fly_zones",messageLog:"message_log",playback:"playback",altitudeDatumConversion:"altitude_datum_conversion",airspaceStatePositionReports:"airspace_state_position_reports",detailedFlightPanels:"detailed_flight_panels",hideUTMStatusIcons:"hide_utm_status_icons",monitoredFlightZoneIntersects:"monitored_flight_zone_intersects",renderIndividualFlightParts:"render_individual_flight_parts",renderProposedReRouting:"render_proposed_re_routing",projectedAircraft:"projected_aircraft",conflictTraces:"conflict_traces",dronePolicyRegistration:"drone_policy_registration",navigateFlightPlan:"navigate_flight_plan",navigateZone:"navigate_zone",measuringTool:"measuring_tool",disableAirspaceModes:"disable_airspace_modes",appInstallPopup:"app_install_popup",arrowControl:"arrow_control",showConstraints:"show_constraints",trackHiding:"track_hiding",hideMapTileSelector:"hide_map_tile_selector",layerDisplayOptions:"layer_display_options",showResolutionAdvisories:"show_resolution_advisories"};return{initialize:function(e,t){if(a)throw{message:"aa.initialize() has already been called. Only one map may be initialized per page."};a=!0,s.load(e,(function(){t&&t()}))},dispose:function(){s.dispose(),a=!1},api:r,features:l,drawingTypes:{position:"position",vlos:"circle",bvlos:"circles",flightPath:"flight_path",area:"area"},messaging:{messages:{map:{airspacesSelected:"airspacesSelected",flightReportPermissionResponse:"flightReportPermissionResponse",screenshotTaken:"map.screenshotTaken"},mapDrawing:{drawingCompleted:"mapDrawing.drawingCompleted"},dcz:{clearFlightPermission:"dcz.clearFlightPermission",askFlightPermission:"dcz.askFlightPermission"}},sendMessage:o.sendMessage,setMessageCallback:o.setMessageCallback,clearMessageCallback:o.clearMessageCallback}}}();